<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>炊飯 水比率 逆算ツール</title>
  <style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #fafafa;
    color: #222;
    margin: 20px;
    font-size: 18px;
  }

  /* 見出し */
  h1 { font-size: 22px; margin-bottom: 10px; }

  /* ラベルは縦並び */
  label {
    display: block;
    margin: 10px 0 4px 0;
    font-size: 18px;
  }

  /* 入力欄 */
  input[type=number],
  input[type=text] {
    width: 220px;
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
    box-sizing: border-box;
    font-size: 18px;
    display: block;
    margin-bottom: 12px;
    background-color: #d0e7ff; /* 薄い青 */
  }

  /* 補助説明文 */
  .muted { font-size: 0.9rem; color: #666; }
  .note { font-size: 0.85rem; color: #444; margin-top: 6px; }

  /* 結果表示 */
  .result {
    margin-top: 14px;
    padding: 12px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 0 6px rgba(0,0,0,0.06);
    font-size: 18px;
  }

  /* トースト通知 */
  .toast {
    position: fixed;
    left: 50%;
    transform: translateX(-50%);
    bottom: 28px;
    background: #333;
    color: #fff;
    padding: 10px 14px;
    border-radius: 6px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
  }
  .toast.show { opacity: 1; }

  /* 水比率の強調 */
  .water-ratio { color: #42a5f5; font-weight: bold; }
  </style>

</head>
<body>
  <h1>炊飯 — 水比率 逆算ツール</h1>

  <p class="muted">内釜の重量を測って入力、いつもの手順で準備。 
  </br >いつものお米の重量を測って入力。
  </br >いつもの水加減で水を入れる。
  </br >お米＋内釜＋水の合計を測って入力する。
  </br >合計重量ではなく、水の重さ入力でも良い。</p>

  <label>お米の重量 (g) <input id="riceWeight" type="number" min="0" step="1" value="150"></label>
  <label>内釜の重量 (g) <input id="potWeight" type="number" min="0" step="1" value="500"></label>

  <hr style="margin:12px 0">

 <div class="note">お米＋内釜＋水の合計重量・水の重さ、どちらかを入力してください）</div>

  <label>お米＋内釜＋水 の合計重量 (g) <input id="totalMeasured" type="number" min="0" step="1" placeholder="例: 800"></label>
 
  <label>水の重量 (g)  <input id="waterWeightDirect" type="number" min="0" step="1" placeholder="合計重量 未入力時必須"></label>

  <div class="result" id="result">
    <strong>計算結果：</strong>
    <div id="resultBody" class="note">入力するとリアルタイムで結果が表示されます。</div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    const $ = id => document.getElementById(id);

    function showToast(msg, ms = 1600) {
      const t = $('toast'); t.textContent = msg; t.classList.add('show');
      clearTimeout(t._t); t._t = setTimeout(()=> t.classList.remove('show'), ms);
    }

    function calc() {
      const rice = parseFloat($('riceWeight').value) || 0;
      const pot = parseFloat($('potWeight').value) || 0;
      const totalMeasured = parseFloat($('totalMeasured').value);
      const waterDirect = parseFloat($('waterWeightDirect').value);

      if (rice <= 0) {
        $('resultBody').innerHTML = '<span style="color:#c62828">お米の重量は 0 より大きい値を入力してください。</span>';
        return;
      }

      let water = null;
      if (!isNaN(waterDirect) && waterDirect >= 0) {
        water = waterDirect;
      } else if (!isNaN(totalMeasured) && totalMeasured >= 0) {
        water = totalMeasured - rice - pot;
      } else {
        $('resultBody').innerHTML = '<span class="muted">合計重量 または 水の重さ のどちらかを入力してください。</span>';
        return;
      }

      if (water < 0) {
        $('resultBody').innerHTML = '<span style="color:#c62828">水の重さが負になります。入力値を確認してください。</span>';
        return;
      }

      const waterRatio = water / rice;
      const ricePlusWater = rice + water;
      const total = ricePlusWater + pot;
      const go = rice / 150;

      $('resultBody').innerHTML = `
        水の重さ: <strong>${Math.round(water)} g</strong><br>
        水比率 (水 / お米): <span class="water-ratio">${waterRatio.toFixed(3)}</span><br>
        お米＋水: <strong>${Math.round(ricePlusWater)} g</strong><br>
        お米＋水＋内釜: <strong>${Math.round(total)} g</strong><br>
        お米の目安: 約 <strong>${go.toFixed(2)}</strong> 合
      `;
    }

    ['riceWeight','potWeight','totalMeasured','waterWeightDirect'].forEach(id=>{
      $(id).addEventListener('input', ()=>{
        const val = $(id).value;
        if (val !== '') {
          clearTimeout($(id)._timer);
          $(id)._timer = setTimeout(calc, 180);
        }
      });
    });

    window.addEventListener('load', calc);
  </script>
</body>
</html>
